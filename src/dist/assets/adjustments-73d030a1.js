import{G as x,h as m,j as h,$ as e,i as E,T as V,F as i,m as N,A as b,x as R,f as k}from"./index-9715db87.js";const j={};j.initialize=function(o){const A=this;x.active_tab_ref=this,x.active_tab="adjustments";function u(){m.send_message(h.MSP_ADJUSTMENT_RANGES,!1,!1,G)}function G(){m.send_message(h.MSP_BOXIDS,!1,!1,U)}function U(){m.send_message(h.MSP_RC,!1,!1,O)}function O(){e("#content").load("./tabs/adjustments.html",F)}m.send_message(h.MSP_BOXNAMES,!1,!1,u);function D(f,s,S){var M,w;const n=e("#tab-adjustments-templates .adjustments .adjustment").clone();e(n).attr("id",`adjustment-${f}`),e(n).data("index",f),N.lt(i.CONFIG.apiVersion,b)&&e(n).find(".adjustmentSlot .slot").val(s.slotIndex);const t=e(n).find(".channelInfo .channel"),l=e(t).find("option");l.remove();for(let a=0;a<S;a++){const r=l.clone();r.text(`AUX ${a+1}`),r.val(a),t.append(r)}t.val(s.auxChannelIndex),e(n).find(".functionSelection .function").val(s.adjustmentFunction);const d=e(n).find(".functionSwitchChannel .channel"),p=e(d).find("option");p.remove();let c;for(let a=0;a<S;a++)c=p.clone(),c.text(`AUX ${a+1}`),c.val(a),d.append(c);d.val(s.auxSwitchChannelIndex);const I={min:[900],max:[2100]};let T=[1300,1700];s.range!=null&&(T=[s.range.start,s.range.end]);let _=e(n).find(".range");e(_).find(".channel-slider").noUiSlider({start:T,behaviour:"snap-drag",margin:25,step:25,connect:!0,range:I,format:wNumb({decimals:0})}),e(n).find(".channel-slider").Link("lower").to(e(n).find(".lowerLimitValue")),e(n).find(".channel-slider").Link("upper").to(e(n).find(".upperLimitValue")),e(_).find(".pips-channel-range").noUiSlider_pips({mode:"values",values:[900,1e3,1200,1400,1500,1600,1800,2e3,2100],density:4,stepped:!0});const v=e(n).find(".enable");e(v).data("adjustmentElement",n),e(v).change(function(){const a=e(this).data("adjustmentElement");if(e(this).prop("checked")){e(a).find(":input").prop("disabled",!1),e(a).find(".channel-slider").removeAttr("disabled"),_=e(a).find(".range .channel-slider");const r=e(_).val();if(r[0]==r[1]){const J=[1300,1700];e(_).val(J)}}else e(a).find(":input").prop("disabled",!0),e(a).find(".channel-slider").attr("disabled","disabled");e(this).prop("disabled",!1)});const L=((M=s==null?void 0:s.range)==null?void 0:M.start)!==((w=s==null?void 0:s.range)==null?void 0:w.end);return e(v).prop("checked",L).change(),n}function F(){A.adjust_template();let f=i.RC.active_channels-4;const s=e(".tab-adjustments .adjustments tbody");for(let t=0;t<i.ADJUSTMENT_RANGES.length;t++){const l=D(t,i.ADJUSTMENT_RANGES[t],f);s.append(l)}N.gte(i.CONFIG.apiVersion,b)&&(e(".tab-adjustments .adjustmentSlotsHelp").hide(),e(".tab-adjustments .adjustmentSlotHeader").hide(),e(".tab-adjustments .adjustmentSlot").hide()),E.localizePage(),e("a.save").click(function(){const t=i.ADJUSTMENT_RANGES.length;i.ADJUSTMENT_RANGES=[];const l={slotIndex:0,auxChannelIndex:0,range:{start:900,end:900},adjustmentFunction:0,auxSwitchChannelIndex:0};e(".tab-adjustments .adjustments .adjustment").each(function(){const d=e(this);if(e(d).find(".enable").prop("checked")){const p=e(this).find(".range .channel-slider").val();let c=0;N.lt(i.CONFIG.apiVersion,b)&&(c=parseInt(e(this).find(".adjustmentSlot .slot").val()));const I={slotIndex:c,auxChannelIndex:parseInt(e(this).find(".channelInfo .channel").val()),range:{start:p[0],end:p[1]},adjustmentFunction:parseInt(e(this).find(".functionSelection .function").val()),auxSwitchChannelIndex:parseInt(e(this).find(".functionSwitchChannel .channel").val())};i.ADJUSTMENT_RANGES.push(I)}else i.ADJUSTMENT_RANGES.push(l)});for(let d=i.ADJUSTMENT_RANGES.length;d<t;d++)i.ADJUSTMENT_RANGES.push(l);R.sendAdjustmentRanges(g);function g(){m.send_message(h.MSP_EEPROM_WRITE,!1,!1,function(){k(E.getMessage("adjustmentsEepromSaved"))})}});function S(t,l){l<900?l=900:l>2100&&(l=2100);const g=(l-900)/(2100-900)*100;e(".adjustments .adjustment").each(function(){e(this).find(".channel").val()==t&&e(this).find(".range .marker").css("left",`${g}%`)})}function C(){m.send_message(h.MSP_RC,!1,!1,n)}function n(){f=i.RC.active_channels-4;for(let t=0;t<f;t++)S(t,i.RC.channels[t+4])}n(),x.interval_add("aux_data_pull",C,50),x.content_ready(o)}};j.cleanup=function(o){o&&o()};j.adjust_template=function(){const o=e("#functionSelectionSelect"),A=31;for(let u=0;u<A;u++)o.append(new Option(E.getMessage(`adjustmentsFunction${u}`),u));o.sortSelect(E.getMessage("adjustmentsFunction0"))};V.adjustments=j;export{j as adjustments};
